Loading data...
Data loaded.

--- Running Experiment 1: K-value impact on Accuracy and Time ---
  Fixed training size: 2500, Fixed testing size: 200

  Initializing KnnClassifier instances for Experiment 1...
  KnnClassifier instances initialized.

  Evaluating k = 1 for all configurations...
    KdTree_NoNorm: Accuracy: 82.00% (Time taken: 1.7380 seconds)
    KdTree_WithNorm: Accuracy: 84.50% (Time taken: 1.7002 seconds)
    BruteForce_NoNorm: Accuracy: 82.00% (Time taken: 0.0921 seconds)
    BruteForce_WithNorm: Accuracy: 84.50% (Time taken: 0.0904 seconds)

  Evaluating k = 2 for all configurations...
    KdTree_NoNorm: Accuracy: 82.00% (Time taken: 1.7395 seconds)
    KdTree_WithNorm: Accuracy: 84.50% (Time taken: 1.6927 seconds)
    BruteForce_NoNorm: Accuracy: 82.00% (Time taken: 0.0889 seconds)
    BruteForce_WithNorm: Accuracy: 84.50% (Time taken: 0.0971 seconds)

  Evaluating k = 3 for all configurations...
    KdTree_NoNorm: Accuracy: 85.50% (Time taken: 1.8138 seconds)
    KdTree_WithNorm: Accuracy: 88.00% (Time taken: 1.8208 seconds)
    BruteForce_NoNorm: Accuracy: 85.50% (Time taken: 0.0954 seconds)
    BruteForce_WithNorm: Accuracy: 88.00% (Time taken: 0.1000 seconds)

  Evaluating k = 4 for all configurations...
    KdTree_NoNorm: Accuracy: 86.50% (Time taken: 1.8182 seconds)
    KdTree_WithNorm: Accuracy: 87.50% (Time taken: 1.8517 seconds)
    BruteForce_NoNorm: Accuracy: 86.50% (Time taken: 0.1225 seconds)
    BruteForce_WithNorm: Accuracy: 87.50% (Time taken: 0.1182 seconds)

  Evaluating k = 5 for all configurations...
    KdTree_NoNorm: Accuracy: 84.00% (Time taken: 1.8840 seconds)
    KdTree_WithNorm: Accuracy: 87.00% (Time taken: 1.9366 seconds)
    BruteForce_NoNorm: Accuracy: 84.00% (Time taken: 0.1059 seconds)
    BruteForce_WithNorm: Accuracy: 87.00% (Time taken: 0.1008 seconds)

  Evaluating k = 6 for all configurations...
    KdTree_NoNorm: Accuracy: 83.00% (Time taken: 1.9554 seconds)
    KdTree_WithNorm: Accuracy: 85.50% (Time taken: 1.9084 seconds)
    BruteForce_NoNorm: Accuracy: 83.00% (Time taken: 0.0944 seconds)
    BruteForce_WithNorm: Accuracy: 85.50% (Time taken: 0.1010 seconds)

  Evaluating k = 7 for all configurations...
    KdTree_NoNorm: Accuracy: 85.50% (Time taken: 1.7877 seconds)
    KdTree_WithNorm: Accuracy: 86.50% (Time taken: 1.7482 seconds)
    BruteForce_NoNorm: Accuracy: 85.50% (Time taken: 0.0932 seconds)
    BruteForce_WithNorm: Accuracy: 86.50% (Time taken: 0.0927 seconds)

  Evaluating k = 8 for all configurations...
    KdTree_NoNorm: Accuracy: 85.00% (Time taken: 1.7371 seconds)
    KdTree_WithNorm: Accuracy: 86.50% (Time taken: 1.7170 seconds)
    BruteForce_NoNorm: Accuracy: 85.00% (Time taken: 0.0913 seconds)
    BruteForce_WithNorm: Accuracy: 86.50% (Time taken: 0.0935 seconds)

  Evaluating k = 9 for all configurations...
    KdTree_NoNorm: Accuracy: 83.50% (Time taken: 1.7441 seconds)
    KdTree_WithNorm: Accuracy: 86.50% (Time taken: 1.7357 seconds)
    BruteForce_NoNorm: Accuracy: 83.50% (Time taken: 0.0925 seconds)
    BruteForce_WithNorm: Accuracy: 86.50% (Time taken: 0.0930 seconds)

--- Experiment 1 completed in 34.11 seconds. ---


--- Best K for BruteForce_WithNorm is 3 with accuracy 88.00% ---

--- Plotting time comparison for fixed K=3 ---

--- Running Experiment 2: Training size impact (Fixed K=3) ---
  Using BruteForce_WithNorm, Fixed testing size: 200

  Processing training size: 200
    Initializing KnnClassifier (BruteForce_WithNorm) with training size 200...
    Evaluating BruteForce_WithNorm with training size 200...
      Accuracy: 75.00%, Time: 0.0045s

  Processing training size: 2000
    Initializing KnnClassifier (BruteForce_WithNorm) with training size 2000...
    Evaluating BruteForce_WithNorm with training size 2000...
      Accuracy: 86.50%, Time: 0.0363s

  Processing training size: 5000
    Initializing KnnClassifier (BruteForce_WithNorm) with training size 5000...
    Evaluating BruteForce_WithNorm with training size 5000...
      Accuracy: 89.00%, Time: 0.1989s

  Processing training size: 10000
    Initializing KnnClassifier (BruteForce_WithNorm) with training size 10000...
    Evaluating BruteForce_WithNorm with training size 10000...
      Accuracy: 90.50%, Time: 0.4000s

--- Experiment 2 completed in 0.65 seconds. ---


--- Final: Detailed visualization for BruteForce_WithNorm at its optimal K ---

--- Evaluation Metrics ---
Overall Accuracy: 88.00%

Per-class Metrics:
  Class 0:
    Precision: 0.9286
    Recall:    1.0000
    F1-score:  0.9630
  Class 1:
    Precision: 0.8696
    Recall:    1.0000
    F1-score:  0.9302
  Class 2:
    Precision: 0.8571
    Recall:    0.6000
    F1-score:  0.7059
  Class 3:
    Precision: 1.0000
    Recall:    0.7895
    F1-score:  0.8824
  Class 4:
    Precision: 0.8182
    Recall:    0.8571
    F1-score:  0.8372
  Class 5:
    Precision: 0.8571
    Recall:    1.0000
    F1-score:  0.9231
  Class 6:
    Precision: 0.9600
    Recall:    0.9600
    F1-score:  0.9600
  Class 7:
    Precision: 0.8800
    Recall:    0.8800
    F1-score:  0.8800
  Class 8:
    Precision: 0.8400
    Recall:    0.9130
    F1-score:  0.8750
  Class 9:
    Precision: 0.8261
    Recall:    0.8636
    F1-score:  0.8444

Macro-averaged F1-score: 0.8801
Weighted-average F1-score: 0.8768
Confusion Matrix saved to: images/knn_experiments\BruteForce_WithNorm_k3_Detailed_confusion_matrix.png

--- Displaying 5 Correctly Predicted Images ---
Correct predictions images saved to: images/knn_experiments\BruteForce_WithNorm_k3_Detailed_correct_predictions.png

--- Displaying 5 Incorrectly Predicted Images ---
Incorrect predictions images saved to: images/knn_experiments\BruteForce_WithNorm_k3_Detailed_incorrect_predictions.png      

--- All experiments and visualizations completed. ---